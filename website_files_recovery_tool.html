<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Website Asset Downloader - Smart ZIP Version</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <link rel="stylesheet" href="assets/css/styles.css" />
    <!-- Font Awesome CDN for Instagram icon -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
      integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <script src="website_recovery.js"></script>

    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          sans-serif;
        background: #fff9e3;
        min-height: 100vh;
        padding: 20px;
        line-height: 1.6;
      }

      .container {
        max-width: 900px;
        margin: 0 auto;
        background: white;
        border-radius: 20px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        overflow: hidden;
      }

      .header {
        padding: 40px;
        text-align: center;
      }

      .header h1 {
        font-size: 2.5rem;
        margin-bottom: 10px;
        font-weight: 700;
      }

      .header p {
        font-size: 1.1rem;
        opacity: 0.9;
        max-width: 600px;
        margin: 0 auto;
      }

      .content {
        padding: 40px;
      }

      .download-section {
        background: #f8f9fa;
        padding: 30px;
        border-radius: 16px;
        margin-bottom: 30px;
        border: 2px solid #e9ecef;
        transition: all 0.3s ease;
      }

      .download-section:hover {
        border-color: #2c5530;
        box-shadow: 0 8px 25px rgba(44, 85, 48, 0.1);
      }

      .input-group {
        margin: 20px 0;
        display: flex;
        align-items: center;
        gap: 15px;
        flex-wrap: wrap;
      }

      input[type="text"] {
        padding: 15px 20px;
        flex: 1;
        min-width: 300px;
        border: 2px solid #e9ecef;
        border-radius: 12px;
        font-size: 16px;
        transition: all 0.3s ease;
        background: white;
      }

      input[type="text"]:focus {
        outline: none;
        border-color: #2c5530;
        box-shadow: 0 0 0 3px rgba(44, 85, 48, 0.1);
      }

      button {
        padding: 15px 30px;
        background: linear-gradient(135deg, #2c5530 0%, #3a5d47 100%);
        color: white;
        border: none;
        border-radius: 12px;
        cursor: pointer;
        font-size: 16px;
        font-weight: 600;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(44, 85, 48, 0.3);
      }

      button:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(44, 85, 48, 0.4);
      }

      button:disabled {
        background: #ccc;
        cursor: not-allowed;
        transform: none;
        box-shadow: none;
      }

      #downloadStatus {
        margin-top: 20px;
        font-size: 14px;
        padding: 15px;
        border-radius: 12px;
        font-weight: 500;
      }

      .status-info {
        background: #e3f2fd;
        color: #1565c0;
        border-left: 4px solid #2196f3;
      }

      .status-success {
        background: #e8f5e8;
        color: #2e7d32;
        border-left: 4px solid #4caf50;
      }

      .status-warning {
        background: #fff8e1;
        color: #f57c00;
        border-left: 4px solid #ff9800;
      }

      .status-error {
        background: #ffebee;
        color: #c62828;
        border-left: 4px solid #f44336;
      }

      .file-list {
        background: white;
        border: 2px solid #e9ecef;
        border-radius: 12px;
        padding: 20px;
        margin: 20px 0;
        max-height: 300px;
        overflow-y: auto;
      }

      .file-item {
        padding: 10px 0;
        border-bottom: 1px solid #f0f0f0;
        font-family: "SF Mono", Monaco, "Cascadia Code", monospace;
        font-size: 14px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        transition: background 0.2s ease;
      }

      .file-item:hover {
        background: #f8f9fa;
      }

      .file-item:last-child {
        border-bottom: none;
      }

      .file-status {
        font-size: 12px;
        padding: 4px 8px;
        border-radius: 6px;
        font-weight: 600;
      }

      .status-pending {
        background: #e9ecef;
        color: #6c757d;
      }

      .status-downloading {
        background: #cce5ff;
        color: #004085;
      }

      .status-success {
        background: #d4edda;
        color: #155724;
      }

      .status-failed {
        background: #f8d7da;
        color: #721c24;
      }

      .progress-bar {
        width: 100%;
        height: 12px;
        background: #e9ecef;
        border-radius: 10px;
        overflow: hidden;
        margin: 20px 0;
        box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, #2c5530 0%, #3a5d47 100%);
        width: 0%;
        transition: width 0.3s ease;
        border-radius: 10px;
      }

      .info-section {
        background: linear-gradient(135deg, #e3f2fd 0%, #f3e5f5 100%);
        border-radius: 16px;
        padding: 30px;
        margin: 30px 0;
        border: 2px solid #e1f5fe;
      }

      .info-section h3 {
        color: #1565c0;
        font-size: 1.5rem;
        margin-bottom: 15px;
        font-weight: 700;
      }

      .info-section p {
        color: #424242;
        margin-bottom: 15px;
        font-size: 1rem;
      }

      .info-section ul {
        list-style: none;
        padding: 0;
      }

      .info-section li {
        padding: 8px 0;
        color: #424242;
        position: relative;
        padding-left: 25px;
      }

      .info-section li::before {
        content: "✨";
        position: absolute;
        left: 0;
        top: 8px;
      }

      .guide-links {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-top: 20px;
      }

      .guide-link {
        background: white;
        border: 2px solid #e9ecef;
        border-radius: 12px;
        padding: 20px;
        text-decoration: none;
        color: #424242;
        transition: all 0.3s ease;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
      }

      .guide-link:hover {
        border-color: #2c5530;
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(44, 85, 48, 0.15);
        text-decoration: none;
        color: #2c5530;
      }

      .guide-link h4 {
        color: #2c5530;
        margin-bottom: 8px;
        font-size: 1.1rem;
        font-weight: 600;
      }

      .guide-link p {
        font-size: 0.9rem;
        margin: 0;
        opacity: 0.8;
      }

      .footer {
        background: #f8f9fa;
        padding: 30px;
        text-align: center;
        border-top: 2px solid #e9ecef;
      }

      .footer-content {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 20px;
      }

      .footer-brand {
        display: flex;
        align-items: center;
        gap: 15px;
      }

      .brand-logo {
        width: 60px;
        height: auto;
        object-fit: contain;
      }

      .footer-text {
        color: #666;
        font-size: 1rem;
        margin: 0;
      }

      .footer-links {
        display: flex;
        gap: 30px;
        align-items: center;
        flex-wrap: wrap;
        justify-content: center;
      }

      .footer-link {
        color: #2c5530;
        text-decoration: none;
        font-weight: 600;
        font-size: 1rem;
        transition: color 0.3s ease;
      }

      .footer-link:hover {
        color: #1a3d1f;
        text-decoration: underline;
      }

      .contact-link {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        color: #2c5530;
        text-decoration: none;
        font-weight: 600;
        font-size: 1rem;
        transition: color 0.3s ease;
      }

      .contact-link:hover {
        color: #1a3d1f;
        text-decoration: underline;
      }

      .contact-link i {
        font-size: 1.2rem;
      }

      .link-button {
        display: inline-flex;
        align-items: center;
        gap: 12px;
        padding: 18px 36px;
        background: linear-gradient(135deg, #007aff 0%, #5856d6 100%);
        color: white;
        border: 2px solid transparent;
        border-radius: 16px;
        cursor: pointer;
        font-size: 18px;
        font-weight: 700;
        transition: all 0.3s ease;
        box-shadow: 0 6px 20px rgba(0, 122, 255, 0.3);
        text-decoration: none;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        position: relative;
        overflow: hidden;
      }

      .link-button::before {
        content: "";
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(
          90deg,
          transparent,
          rgba(255, 255, 255, 0.2),
          transparent
        );
        transition: left 0.5s ease;
      }

      .link-button:hover::before {
        left: 100%;
      }

      .link-button:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 25px rgba(0, 122, 255, 0.4);
        background: linear-gradient(135deg, #0056cc 0%, #4a4a9e 100%);
      }

      .link-button:active {
        transform: translateY(-1px);
      }

      @media (max-width: 768px) {
        .container {
          margin: 10px;
          border-radius: 16px;
        }

        .header {
          padding: 30px 20px;
        }

        .header h1 {
          font-size: 2rem;
        }

        .content {
          padding: 20px;
        }

        .input-group {
          flex-direction: column;
          align-items: stretch;
        }

        input[type="text"] {
          min-width: auto;
        }

        button {
          width: 100%;
        }

        .link-button {
          width: 100%;
          justify-content: center;
          font-size: 16px;
          padding: 16px 24px;
        }

        .footer-links {
          flex-direction: column;
          gap: 15px;
        }

        .footer-brand {
          flex-direction: column;
          text-align: center;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>Website Files Recovery Tool</h1>
        <p>
          Download all your website files and automatically generate
          configuration files for easy deployment
        </p>
      </div>

      <div class="content">
        <div class="download-section">
          <div class="input-group">
            <input type="text" id="domainInput" placeholder="yourdomain.com" />
            <button onclick="smartDownload()" id="downloadBtn">
              📥 Download Files
            </button>
          </div>

          <div class="progress-bar">
            <div class="progress-fill" id="progressBar"></div>
          </div>

          <div
            id="downloadStatus"
            class="status-info"
            style="display: none"
          ></div>

          <div id="fileList" class="file-list" style="display: none">
            <h4>Files Discovered:</h4>
            <div id="fileItems"></div>
          </div>
        </div>

        <div class="info-section">
          <h3>🚀 What's Next?</h3>
          <p>
            Once you've downloaded your website files, you might want to make
            some changes. View our guides to get you started:
          </p>
          <p></p>
          <a
            href="https://airliftstudios.com/guides"
            class="link-button"
            target="_blank"
            rel="noopener"
          >
            📖 View Guides
          </a>
        </div>
      </div>

      <div class="footer">
        <div class="footer-content">
          <div class="footer-brand">
            <img
              src="assets/images/logo.png"
              alt="Airlift Studios logo"
              class="brand-logo"
              loading="lazy"
            />
            <p class="footer-text">Built with ❤️ by Airliftstudios.com</p>
          </div>

          <div class="footer-links">
            <a
              href="https://www.instagram.com/airlift.studios"
              class="contact-link"
              target="_blank"
              rel="noopener"
            >
              <i class="fab fa-instagram"></i> airlift.studios
            </a>
          </div>
        </div>
      </div>
    </div>

    <script>
      let websiteRecovery = new WebsiteRecovery();

      async function smartDownload() {
        const domain = document.getElementById("domainInput").value.trim();
        const statusDiv = document.getElementById("downloadStatus");
        const downloadBtn = document.getElementById("downloadBtn");
        const progressBar = document.getElementById("progressBar");
        const fileList = document.getElementById("fileList");
        const fileItems = document.getElementById("fileItems");

        if (!domain) {
          showStatus("Please enter your domain name", "error");
          return;
        }

        downloadBtn.disabled = true;
        downloadBtn.textContent = "Analyzing...";

        try {
          const zipBlob = await websiteRecovery.downloadWebsiteAsZip(
            domain,
            (progress, file, current, total) => {
              progressBar.style.width = `${progress}%`;
            },
            (message, type) => {
              showStatus(message, type);
            }
          );

          // Download the ZIP file
          const downloadUrl = window.URL.createObjectURL(zipBlob);
          const link = document.createElement("a");
          link.href = downloadUrl;
          link.download = `${domain
            .replace(/^https?:\/\//, "")
            .replace(/^www\./, "")
            .replace(/\/$/, "")}-backup.zip`;
          document.body.appendChild(link);
          link.click();
          document.body.removeChild(link);
          window.URL.revokeObjectURL(downloadUrl);
        } catch (error) {
          showStatus(`Error: ${error.message}`, "error");
          console.error("Download error:", error);
        }

        downloadBtn.disabled = false;
        downloadBtn.textContent = "Download";
      }

      function showStatus(message, type) {
        const statusDiv = document.getElementById("downloadStatus");
        statusDiv.textContent = message;
        statusDiv.className = `status-${type}`;
        statusDiv.style.display = "block";
      }

      // Allow Enter key to trigger download
      document
        .getElementById("domainInput")
        .addEventListener("keypress", function (e) {
          if (e.key === "Enter") {
            smartDownload();
          }
        });
    </script>
  </body>
</html>
